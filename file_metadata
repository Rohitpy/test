from fastapi import FastapI, HTTPException, APIRouter, Depends, status from fastapi security import Auth2PasswordRequestForm from app. services authentication. Idap_auth import AuthService from app.api.schemas.auth import Token

router = APTRouter)
@router. post("/login", response_model-Token)
async def login(
Rohit11 KUMAR, 2 weeks ago â€¢ Added ...
form_data: OAuth2PasswordRequestForm - Depends),
):
SVC = AuthService()
try:
token - await sc. authenticate(form data.username, form data-password)
except ValueError as e:
detail - "Invalid user" if str(e) == "invalid user" else "Invalid credentials" raise HTTPException(
status_code=status.HTTP_401_UNAUTHORIZED, detail-detail, headers={"WWw-Authenticate": "Bearer"},
return {"access_token"; token}
